library(ready4class)
ready4fun::write_fn_type_dirs()
pkg_desc_ls <- ready4fun::make_pkg_desc_ls(pkg_title_1L_chr = "Retrieve and Manage Data In Open and Modular Mental Health Simulations" %>% tools::toTitleCase(),
                                           pkg_desc_1L_chr = "ready4use provides a set of tools for general data management tasks when developping open source, modular mental health simulation models.
  This development version of the ready4use package has been made available as part of the process of testing and documenting the package. The tools contained in this development release automate a number of tasks which MODIFY THE DIRECTORY STRUCTURE OF YOUR LOCAL MACHINE.
  Therefore you should only trial this software if you feel confident that you understand what it does and have created a sandpit area in which you can safely undertake testing. If you have any questions, please contact the authors (matthew.hamilton@orygen.org.au).",
                                           authors_prsn = c(utils::person(
                                             given = "Matthew",family = "Hamilton", email =
                                               "matthew.hamilton@orygen.org.au",role = c("aut",
                                                                                         "cre"),comment = c(ORCID = "0000-0001-7407-9194")
                                           ),
                                           utils::person("Glen", "Wiesner", email = "Glen.Wiesner@vu.edu.au",
                                                         role = c("aut"), comment = c(ORCID = "0000-0002-0071-130X")),
                                           #person("Alexandra", "Parker", email =  "Alex.Parker@vu.edu.au", role = c("rev"), comment = c(ORCID ="0000-0002-2398-6306")),
                                           #person("Cathrine", "Mihalopoulos",email = "cathy.mihalopoulos@deakin.edu.au", role = c("rev"), comment = c(ORCID = "0000-0002-7127-9462")),
                                           #person("Jonathan", "Karnon", email ="Jonathan.Karnon@flinders.edu.au", role = c("rev"), comment =c(ORCID = "0000-0003-3220-2099")),
                                           #person("Petra","Plencnerova", email = "Petra.Plencnerova@vu.edu.au", role =c("rev"), comment = c(ORCID = "0000-0001-9698-9084")),
                                           utils::person("Orygen", role = c("cph", "fnd")),
                                           utils::person("VicHealth",role = c("fnd")),
                                           utils::person("Victoria University", role =c("fnd"))
                                           ),
                                           urls_chr = c("https://ready4-dev.github.io/ready4use/",
                                                        "https://github.com/ready4-dev/ready4use",
                                                        "https://ready4-dev.github.io/ready4/"))
pkg_setup_r3 <- pkg_desc_ls %>%
  ready4fun::make_pkg_setup_ls(addl_pkgs_ls = ready4fun::make_addl_pkgs_ls(suggests_chr = "rmarkdown"),
                               build_ignore_ls = ready4fun::make_build_ignore_ls(file_nms_chr = c("initial_setup.R")), #
                               # badges_lup = ready4fun::badges_lup, # Change ready4fun fn to make this default.
                               check_type_1L_chr = "ready4",
                               # cls_fn_ls = ready4fun::make_pt_ready4fun_fn_ls(args_ls = list(x = constructor_tbl_r3,
                               #                                                               fn =  ready4class::author.ready4class_constructor_tbl)) %>%
                               #   ready4fun::ready4fun_fn_ls(),
                               copyright_holders_chr = "Orygen",
                               dev_pkgs_chr = c("ready4fun","ready4class"),
                               lifecycle_stage_1L_chr = "experimental",
                               path_to_pkg_logo_1L_chr = "../../../../../Documentation/Images/ready4use-logo/default.png",
                               pkg_dmt_dv_dss_chr = c("https://doi.org/10.7910/DVN/HLLXZN",
                                                      "https://doi.org/10.7910/DVN/2Y9VF9"),
                               ready4_type_1L_chr = "authoring",
                               user_manual_fns_chr = c("add_labels_from_dictionary",
                                                       "assert_matches_chr",
                                                       "assert_single_row_tb",
                                                       "get_fl_id_from_dv_ls",
                                                       "get_r3_from_dv_csv",
                                                       "write_fls_to_dv_ds"))
constructor_tbl_r3 <- dplyr::bind_rows(
  ready4class::make_pt_ready4class_constructor_tbl(make_s3_lgl = TRUE,
                                                   name_stub_chr = "dist",
                                                   pt_ls = list(list("list")),
                                                   pt_chkr_pfx_ls = list(list("is.")),
                                                   pt_ns_ls = list(list("base")),
                                                   vals_ls = list(list(distribution_chr = "character(0)",
                                                                       dstr_param_1_dbl = "numeric(0)",
                                                                       dstr_param_2_dbl = "numeric(0)",
                                                                       dstr_param_3_dbl = "numeric(0)",
                                                                       dstr_param_4_dbl = "numeric(0)",
                                                                       transformation_chr = "character(0)")),
                                                   class_desc_chr = "ready4 S3 class for list object that summarises the parameters of each distribution"),
  ready4class::make_pt_ready4class_constructor_tbl(make_s3_lgl = TRUE,
                                                   name_stub_chr = "dv_import_lup",
                                                   pt_ls = list(list("tibble")),
                                                   pt_chkr_pfx_ls = list(list("is_")),
                                                   pt_ns_ls = list(list("tibble")),
                                                   vals_ls = list(list(file_type_chr = "character(0)",
                                                                       file_name_chr = "character(0)",
                                                                       data_repo_chr = "character(0)",
                                                                       data_repo_ui_chr = "character(0)",
                                                                       data_repo_db_ui_chr = "character(0)",
                                                                       data_repo_file_ext_chr = "character(0)",
                                                                       data_repo_save_type_chr = "character(0)")),
                                                   class_desc_chr = "ready4 S3 class for tibble object lookup table of files to be imported from a dataverse."),
  ready4class::make_pt_ready4class_constructor_tbl(make_s3_lgl = TRUE,
                                                   name_stub_chr = "all_import_lup",
                                                   pt_ls = list(list("tibble")),
                                                   pt_chkr_pfx_ls = list(list("is_")),
                                                   pt_ns_ls = list(list("tibble")),
                                                   vals_ls = list(list(local_file_src_chr = "character(0)",
                                                                       path_to_make_script_chr = "character(0)",
                                                                       download_url_chr = "character(0)",
                                                                       inc_file_main_chr = "character(0)",
                                                                       inc_fls_to_rename_ls = "list()",
                                                                       new_nms_for_inc_fls_ls = "list()")),
                                                   class_desc_chr = "ready4 S3 class for tibble object lookup table of sources of raw (un-processed) data to import.",
                                                   parent_class_chr = "ready4use_dv_import_lup"),
  ready4class::make_pt_ready4class_constructor_tbl(make_s3_lgl = TRUE,
                                                   name_stub_chr = "param_struc_mape",
                                                   pt_ls = list(list("tibble")),
                                                   pt_chkr_pfx_ls = list(list("is_")),
                                                   pt_ns_ls = list(list("tibble")),
                                                   vals_ls = list(list(param_name_chr = "character(0)",
                                                                       sex_age_band_chr = "character(0)",
                                                                       mape_05_yr_mde_dbl = "numeric(0)",
                                                                       mape_10_yr_mde_dbl = "numeric(0)",
                                                                       mape_15_yr_mde_dbl = "numeric(0)",
                                                                       mape_05_yr_min_dbl = "numeric(0)",
                                                                       mape_10_yr_min_dbl = "numeric(0)",
                                                                       mape_15_yr_min_dbl = "numeric(0)",
                                                                       mape_05_yr_max_dbl = "numeric(0)",
                                                                       mape_10_yr_max_dbl = "numeric(0)",
                                                                       mape_15_yr_max_dbl = "numeric(0)",
                                                                       mape_05_yr_shp_dbl = "numeric(0)",
                                                                       mape_10_yr_shp_dbl = "numeric(0)",
                                                                       mape_15_yr_shp_dbl = "numeric(0)")),
                                                   class_desc_chr = "ready4 S3 class for tibble object that stores simulation structural parameters relating to Mean Absolute Prediction Errors."),
  ready4class::make_pt_ready4class_constructor_tbl(make_s3_lgl = T,
                                                   name_stub_chr = "dictionary",
                                                   pt_ls = list(list("tibble")),
                                                   pt_chkr_pfx_ls = list(list("is_")),
                                                   pt_ns_ls = list(list("tibble")),
                                                   vals_ls = list(list(var_nm_chr = "character(0)",
                                                                       var_ctg_chr = "character(0)",
                                                                       var_desc_chr = "character(0)",
                                                                       var_type_chr = "character(0)")),
                                                   class_desc_chr= "ready4 s3 class defining a data dictionary tibble."),
  ready4class::make_pt_ready4class_constructor_tbl(make_s3_lgl = FALSE,
                                                   name_stub_chr = "local",
                                                   slots_ls = c("merge_with_chr_vec","raw_data_dir_chr","pckg_chr","overwrite_lgl", "save_lgl") %>% list(), # Cut: "lup_tbs_r4",
                                                   pt_ls = c("character","character","character","logical", "logical") %>% list(), # Cut: "ready4class_lookup",
                                                   class_desc_chr= "ready4 S4 class defining data to be saved in local directory.",
                                                   parent_class_chr = NA_character_), # Cut: ,include_classes = list("ready4class_lookup")
  ready4class::make_pt_ready4class_constructor_tbl(make_s3_lgl = FALSE,
                                                   name_stub_chr = "local_raw",
                                                   slots_ls = c("save_type") %>% list(),
                                                   pt_ls = c("character") %>% list(),
                                                   vals_ls = list(save_type ="raw"),
                                                   allowed_vals_ls = list(save_type = "raw"),
                                                   class_desc_chr= "ready4 S4 class defining data to be saved in local directory in a raw (unprocessed) format.",
                                                   parent_class_chr = "ready4use_local",
                                                   inc_clss_ls = list("ready4use_local")),
  ready4class::make_pt_ready4class_constructor_tbl(make_s3_lgl = FALSE,
                                                   name_stub_chr = "local_proc",
                                                   slots_ls = c("save_type","proc_data_dir_chr","import_chr_vec","path_to_starter_sf_chr","import_this_ls") %>% list(),
                                                   pt_ls = c("character","character","character","character","list") %>% list(),
                                                   vals_ls = list(save_type = "proc"),
                                                   allowed_vals_ls = list(save_type = "proc"),
                                                   class_desc_chr= "ready4 S4 class defining data to be saved in local directory in a processed (R) format.",
                                                   parent_class_chr = "ready4use_local",
                                                   inc_clss_ls = list("ready4use_local")),
  ready4class::make_pt_ready4class_constructor_tbl(make_s3_lgl = FALSE,
                                                   name_stub_chr = "script_data",
                                                   slots_ls = c("crs_nbr_dbl") %>% list(), # Change
                                                   pt_ls = c("numeric") %>% list(),
                                                   class_desc_chr= "ready4 S4 class containing data to be passed to a function that constructs a spatial object from a lookup table.",
                                                   parent_class_chr = "ready4use_local_proc",
                                                   inc_clss_ls = list("ready4use_local_proc"))
) %>%
  ready4class::ready4class_constructor_tbl()
manifest_r3 <- ready4class::ready4class_manifest(make_pt_ready4class_manifest(pkg_setup_r3 = pkg_setup_r3,
                                                                 constructor_tbl_r3 = constructor_tbl_r3))
#pkg_ds_ls_ls <- NULL
library(ready4fun)
pkg_setup_r3 <- ready4class::author.ready4class_manifest(manifest_r3)
# pkg_setup_r3 <-  ready4fun::write_package(pkg_setup_ls,
#                                          self_serve_1L_lgl = F,
#                                          self_serve_fn_ls = NULL)
# pkg_setup_ls$subsequent_ls$abbreviations_lup <- pkg_setup_ls$subsequent_ls$abbreviations_lup %>%
#   dplyr::filter(!short_name_chr %in% c("ready4classs"))
# pkg_setup_ls <- ready4fun::update_msng_abbrs(pkg_setup_ls,
#                                   are_words_chr = c("download", "recode"))
# pkg_setup_ls <- ready4fun::write_new_abbrs(pkg_setup_ls,
#                                            long_name_chr = c("ready4use R package"),
#                                            no_plural_chr = c("ready4use R package"))
# pkg_setup_ls$subsequent_ls$fn_types_lup <- pkg_setup_ls$subsequent_ls$fn_types_lup %>%
#   dplyr::filter(fn_type_nm_chr != "Bind Lups")
# ready4fun::write_new_fn_types(pkg_setup_ls, fn_type_desc_chr = "Rowbinds lookup tables of the same class, removing duplicates based on priority.")
